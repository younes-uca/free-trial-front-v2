<div class="p-grid">
    <div class="p-col-12">
        <p-toast></p-toast>
        <div class="card">
            <p-toolbar styleClass="p-mb-4">
                <ng-template pTemplate="left">
                                            <button pButton pRipple label="Nouveau" icon="pi pi-plus" class="p-button-success p-mr-2 p-mb-2"
                                (click)="openCreateFreeTrial('freeTrial')"></button>

                    <button [disabled]="isSelectionDisabled()" pButton pRipple label="Supprimer" icon="pi pi-trash" class="p-button-danger p-mr-2 p-mb-2" (click)=deleteMultiple()></button>
                    <button pButton pRipple label="Chercher"
                            icon="pi pi-{{findByCriteriaShow?'angle-down':'angle-right'}}"
                            class="p-button-warning p-mr-2 p-mb-2"
                            (click)="this.findByCriteriaShow = !this.findByCriteriaShow"></button>
                </ng-template>
                <ng-template pTemplate="right">
                    <div class="flex">
                        <p-splitButton label="Exporter" icon="pi pi-download" styleClass="p-button-help" [model]="excelPdfButons"></p-splitButton>
                    </div>
                </ng-template>

            </p-toolbar>
            <p-toolbar *ngIf="findByCriteriaShow">

                <div class="align-form-search">
                            <span class=" p-float-label p-mr-3 align-search-items p-mt-4">
                                <p-dropdown [options]="teachers" [(ngModel)]="search.teacher"
                                        id="1"
                                        [filter]="true" [showClear]="true"  placeholder="Teacher"
                                        optionLabel="libelle">
                                </p-dropdown>
                            </span>
                            <span class=" p-float-label p-mr-3 align-search-items p-mt-4">
                                <p-dropdown [options]="levels" [(ngModel)]="search.level"
                                        id="2"
                                        [filter]="true" [showClear]="true"  placeholder="Level"
                                        optionLabel="libelle">
                                </p-dropdown>
                            </span>

                        <span class=" p-float-label p-mr-3 align-search-items p-mt-4">
                            <p-calendar
                                    class="p-mr-2" [(ngModel)]="search.dateFreeTrialFrom"
                                    id="3-1"
                                    dateFormat="dd-MM-yy"></p-calendar>
                            <label for="3-1">Date free trial Min</label>
                        </span>

                         <span class=" p-float-label p-mr-3 align-search-items p-mt-4">
                            <p-calendar
                                    class="p-mr-2" [(ngModel)]="search.dateFreeTrialTo"
                                    id="3-2"
                                    dateFormat="dd-MM-yy"></p-calendar>
                            <label for="3-2">Date free trial Max</label>
                        </span>

                                <span class=" p-float-label p-mr-3 align-search-items p-mt-4">
                                    <input class="p-mr-2" pInputText id="4"
                                           type="text"  [(ngModel)]="search.linkLike">
                                    <label for="4">Link</label>
                                </span>
                            <span class=" p-float-label p-mr-3 align-search-items p-mt-4">
                                <p-dropdown [options]="freeTrialStudentWhatsTemplates" [(ngModel)]="search.freeTrialStudentWhatsTemplate"
                                        id="5"
                                        [filter]="true" [showClear]="true"  placeholder="Free trial student whats template"
                                        optionLabel="id">
                                </p-dropdown>
                            </span>
                            <span class=" p-float-label p-mr-3 align-search-items p-mt-4">
                                <p-dropdown [options]="freeTrialStudentEmailTemplates" [(ngModel)]="search.freeTrialStudentEmailTemplate"
                                        id="6"
                                        [filter]="true" [showClear]="true"  placeholder="Free trial student email template"
                                        optionLabel="id">
                                </p-dropdown>
                            </span>
                            <span class=" p-float-label p-mr-3 align-search-items p-mt-4">
                                <p-dropdown [options]="freeTrialTeacherEmailTemplates" [(ngModel)]="search.freeTrialTeacherEmailTemplate"
                                        id="7"
                                        [filter]="true" [showClear]="true"  placeholder="Free trial teacher email template"
                                        optionLabel="id">
                                </p-dropdown>
                            </span>
                            <span class=" p-float-label p-mr-3 align-search-items p-mt-4">
                                <p-dropdown [options]="freeTrialTeacherWhatsTemplates" [(ngModel)]="search.freeTrialTeacherWhatsTemplate"
                                        id="8"
                                        [filter]="true" [showClear]="true"  placeholder="Free trial teacher whats template"
                                        optionLabel="id">
                                </p-dropdown>
                            </span>

                        <span class=" p-float-label p-mr-3 align-search-items p-mt-4">
                            <p-calendar
                                    class="p-mr-2" [(ngModel)]="search.dateFreeTrialPremierRappelFrom"
                                    id="9-1"
                                    dateFormat="dd-MM-yy"></p-calendar>
                            <label for="9-1">Date free trial premier rappel Min</label>
                        </span>

                         <span class=" p-float-label p-mr-3 align-search-items p-mt-4">
                            <p-calendar
                                    class="p-mr-2" [(ngModel)]="search.dateFreeTrialPremierRappelTo"
                                    id="9-2"
                                    dateFormat="dd-MM-yy"></p-calendar>
                            <label for="9-2">Date free trial premier rappel Max</label>
                        </span>


                        <span class=" p-float-label p-mr-3 align-search-items p-mt-4">
                            <p-calendar
                                    class="p-mr-2" [(ngModel)]="search.dateFreeTrialPremierDeuxiemeRappelFrom"
                                    id="10-1"
                                    dateFormat="dd-MM-yy"></p-calendar>
                            <label for="10-1">Date free trial premier deuxieme rappel Min</label>
                        </span>

                         <span class=" p-float-label p-mr-3 align-search-items p-mt-4">
                            <p-calendar
                                    class="p-mr-2" [(ngModel)]="search.dateFreeTrialPremierDeuxiemeRappelTo"
                                    id="10-2"
                                    dateFormat="dd-MM-yy"></p-calendar>
                            <label for="10-2">Date free trial premier deuxieme rappel Max</label>
                        </span>

                                    <span class=" p-float-label p-mr-3 align-search-items p-mt-4">
                                              <p-inputNumber class="p-mr-2"
                                                             mode="decimal" [(ngModel)]="search.nombreStudentTotalMin"
                                                             id="11-1"></p-inputNumber>
                                              <label for="11-1">Nombre student total Min</label>
                                       </span>
                                       <span class=" p-float-label p-mr-3 align-search-items p-mt-4">
                                              <p-inputNumber class="p-mr-2"
                                                             mode="decimal" [(ngModel)]="search.nombreStudentTotalMax"
                                                             id="11-2"></p-inputNumber>
                                             <label for="11-2">Nombre student total Max</label>
                                       </span>
                            <span class=" p-float-label p-mr-3 align-search-items p-mt-4">
                                <p-dropdown [options]="freeTrialConfigurations" [(ngModel)]="search.freeTrialConfiguration"
                                        id="12"
                                        [filter]="true" [showClear]="true"  placeholder="Free trial configuration"
                                        optionLabel="id">
                                </p-dropdown>
                            </span>
                                    <span class=" p-float-label p-mr-3 align-search-items p-mt-4">
                                              <p-inputNumber class="p-mr-2"
                                                             mode="decimal" [(ngModel)]="search.nombreStudentAbonneMin"
                                                             id="13-1"></p-inputNumber>
                                              <label for="13-1">Nombre student abonne Min</label>
                                       </span>
                                       <span class=" p-float-label p-mr-3 align-search-items p-mt-4">
                                              <p-inputNumber class="p-mr-2"
                                                             mode="decimal" [(ngModel)]="search.nombreStudentAbonneMax"
                                                             id="13-2"></p-inputNumber>
                                             <label for="13-2">Nombre student abonne Max</label>
                                       </span>
                                    <span class=" p-float-label p-mr-3 align-search-items p-mt-4">
                                              <p-inputNumber class="p-mr-2"
                                                             mode="decimal" [(ngModel)]="search.nombreStudentPresentMin"
                                                             id="14-1"></p-inputNumber>
                                              <label for="14-1">Nombre student present Min</label>
                                       </span>
                                       <span class=" p-float-label p-mr-3 align-search-items p-mt-4">
                                              <p-inputNumber class="p-mr-2"
                                                             mode="decimal" [(ngModel)]="search.nombreStudentPresentMax"
                                                             id="14-2"></p-inputNumber>
                                             <label for="14-2">Nombre student present Max</label>
                                       </span>
                            <span class=" p-float-label p-mr-3 align-search-items p-mt-4">
                                <p-dropdown [options]="statutFreeTrials" [(ngModel)]="search.statutFreeTrial"
                                        id="15"
                                        [filter]="true" [showClear]="true"  placeholder="Statut free trial"
                                        optionLabel="libelle">
                                </p-dropdown>
                            </span>
                </div>

                <div class="align-search-button">
                    <button pButton pRipple label="Valider" icon="pi pi-sort-amount-down"
                            class="p-button-info p-mr-2" (click)="searchRequest()"></button>
                </div>
            </p-toolbar>


            <p-table #dt [value]="freeTrials" [columns]="cols" [rows]="8" [paginator]="false"
                    [globalFilterFields]="['teacherlibelle', 'levellibelle', 'dateFreeTrial', 'link', 'freeTrialStudentWhatsTemplateid', 'freeTrialStudentEmailTemplateid', 'freeTrialTeacherEmailTemplateid', 'freeTrialTeacherWhatsTemplateid', 'dateFreeTrialPremierRappel', 'dateFreeTrialPremierDeuxiemeRappel', 'nombreStudentTotal', 'freeTrialConfigurationid', 'nombreStudentAbonne', 'nombreStudentPresent', 'statutFreeTriallibelle']" [(selection)]="freeTrialSelections"
                    [rowHover]="true" dataKey="id" styleClass="p-datatable-customers"
                    currentPageReportTemplate="Les éléments de {first} à {last} sur {total records} "
                    [showCurrentPageReport]="true" [rowsPerPageOptions]="[8,25,50]" selectionMode="multiple">
                <ng-template pTemplate="caption">
                    <div class="p-d-flex p-flex-column p-flex-md-row p-jc-md-between table-header">
                        <h5 class="p-m-0">Liste des free trials</h5>
                        <span class="p-input-icon-left">
                            <i class="pi pi-search"></i>
                            <input pInputText type="text" placeholder="Chercher..." (input)="dt.filterGlobal($event.target.value, 'contains')"/>
                        </span>
                    </div>
                </ng-template>
                <ng-template pTemplate="header">
                    <tr>
                        <th style="width: 3rem">
                            <p-tableHeaderCheckbox></p-tableHeaderCheckbox>
                        </th>

                                
                                <th pSortableColumn="teacher">
                                    <div class="p-d-flex p-jc-between p-ai-center">
                                        <span>Teacher</span>
                                        <p-sortIcon field="teacher"></p-sortIcon>
                                    </div>
                                </th>
                                


                                
                                <th pSortableColumn="level">
                                    <div class="p-d-flex p-jc-between p-ai-center">
                                        <span>Level</span>
                                        <p-sortIcon field="level"></p-sortIcon>
                                    </div>
                                </th>
                                


                                
                                <th pSortableColumn="dateFreeTrial">
                                    <div class="p-d-flex p-jc-between p-ai-center">
                                        <span>Date free trial</span>
                                        <p-sortIcon field="dateFreeTrial"></p-sortIcon>
                                    </div>
                                </th>
                                


                                
                                <th pSortableColumn="link">
                                    <div class="p-d-flex p-jc-between p-ai-center">
                                        <span>Link</span>
                                        <p-sortIcon field="link"></p-sortIcon>
                                        <p-columnFilter type="text" field="freeTrial.link" display="menu" class="ml-auto"></p-columnFilter>
                                    </div>
                                </th>
                                


                               <!--
                                <th pSortableColumn="freeTrialStudentWhatsTemplate">
                                    <div class="p-d-flex p-jc-between p-ai-center">
                                        <span>Free trial student whats template</span>
                                        <p-sortIcon field="freeTrialStudentWhatsTemplate"></p-sortIcon>
                                    </div>
                                </th>
                                


                                
                                <th pSortableColumn="freeTrialStudentEmailTemplate">
                                    <div class="p-d-flex p-jc-between p-ai-center">
                                        <span>Free trial student email template</span>
                                        <p-sortIcon field="freeTrialStudentEmailTemplate"></p-sortIcon>
                                    </div>
                                </th>
                                


                                
                                <th pSortableColumn="freeTrialTeacherEmailTemplate">
                                    <div class="p-d-flex p-jc-between p-ai-center">
                                        <span>Free trial teacher email template</span>
                                        <p-sortIcon field="freeTrialTeacherEmailTemplate"></p-sortIcon>
                                    </div>
                                </th>
                                


                                
                                <th pSortableColumn="freeTrialTeacherWhatsTemplate">
                                    <div class="p-d-flex p-jc-between p-ai-center">
                                        <span>Free trial teacher whats template</span>
                                        <p-sortIcon field="freeTrialTeacherWhatsTemplate"></p-sortIcon>
                                    </div>
                                </th>
                                


                                
                                <th pSortableColumn="dateFreeTrialPremierRappel">
                                    <div class="p-d-flex p-jc-between p-ai-center">
                                        <span>Date free trial premier rappel</span>
                                        <p-sortIcon field="dateFreeTrialPremierRappel"></p-sortIcon>
                                    </div>
                                </th>
                                -->


                                <th pSortableColumn="dateFreeTrialPremierRappel">
                                    <div class="p-d-flex p-jc-between p-ai-center">
                                        <span>Date free trial premier rappel</span>
                                        <p-sortIcon field="dateFreeTrialPremierDeuxiemeRappel"></p-sortIcon>
                                    </div>
                                </th>

                                <th pSortableColumn="dateFreeTrialDeuxiemeRappel">
                                    <div class="p-d-flex p-jc-between p-ai-center">
                                        <span>Date free trial deuxieme rappel</span>
                                        <p-sortIcon field="dateFreeTrialPremierDeuxiemeRappel"></p-sortIcon>
                                    </div>
                                </th>

                                <th pSortableColumn="statutFreeTrial">
                                    <div class="p-d-flex p-jc-between p-ai-center">
                                        <span>Statut free trial</span>
                                        <p-sortIcon field="statutFreeTrial"></p-sortIcon>
                                    </div>
                                </th>


                        <!--
                        <th pSortableColumn="nombreStudentTotal">
                            <div class="p-d-flex p-jc-between p-ai-center">
                                <span>Nombre student total</span>
                                <p-sortIcon field="nombreStudentTotal"></p-sortIcon>
                            </div>
                        </th>
                        -->


                                <!-- 
                                <th pSortableColumn="freeTrialConfiguration">
                                    <div class="p-d-flex p-jc-between p-ai-center">
                                        <span>Free trial configuration</span>
                                        <p-sortIcon field="freeTrialConfiguration"></p-sortIcon>
                                    </div>
                                </th>
                                --> 


                                <!-- 
                                <th pSortableColumn="nombreStudentAbonne">
                                    <div class="p-d-flex p-jc-between p-ai-center">
                                        <span>Nombre student abonne</span>
                                        <p-sortIcon field="nombreStudentAbonne"></p-sortIcon>
                                    </div>
                                </th>
                                --> 


                                <!-- 
                                <th pSortableColumn="nombreStudentPresent">
                                    <div class="p-d-flex p-jc-between p-ai-center">
                                        <span>Nombre student present</span>
                                        <p-sortIcon field="nombreStudentPresent"></p-sortIcon>
                                    </div>
                                </th>
                                --> 





                        <th>Actions</th>
                    </tr>
                </ng-template>
                <ng-template pTemplate="body" let-freeTrial>
                    <tr>
                        <td>
                            <p-tableCheckbox [value]="freeTrial"></p-tableCheckbox>
                        </td>
                            
                                <td>{{freeTrial.teacher?.libelle}}</td>
                                <td>{{freeTrial.level?.libelle}}</td>
                                <td>{{freeTrial.dateFreeTrial | date :'dd/MM/yyyy HH:mm' }}</td>
                                 <td>{{freeTrial.link}}</td>
<!--                             <td>{{freeTrial.freeTrialStudentWhatsTemplate?.id}}</td>
                                <td>{{freeTrial.freeTrialStudentEmailTemplate?.id}}</td>
                                <td>{{freeTrial.freeTrialTeacherEmailTemplate?.id}}</td>
                                <td>{{freeTrial.freeTrialTeacherWhatsTemplate?.id}}</td>-->
                                <td>{{freeTrial.dateFreeTrialPremierRappel | date :'dd/MM/yyyy HH:mm' }}</td>
                                <td>{{freeTrial.dateFreeTrialPremierDeuxiemeRappel | date :'dd/MM/yyyy HH:mm' }}</td>
                                <td>{{freeTrial.statutFreeTrial?.libelle}}</td>

                             <!-- 
                                 <td>{{freeTrial.nombreStudentTotal}}</td>
                             --> 

                             <!-- 
                                <td>{{freeTrial.freeTrialConfiguration?.id}}</td>
                             --> 

                             <!-- 
                                 <td>{{freeTrial.nombreStudentAbonne}}</td>
                             --> 

                             <!-- 
                                 <td>{{freeTrial.nombreStudentPresent}}</td>
                             --> 





                        <td>
                            <button pButton pRipple icon="pi pi-pencil"
                                    class="p-button-rounded p-button-success p-mr-2"
                                    (click)="editFreeTrial(freeTrial)"></button>
                            <button pButton pRipple icon="pi pi-list" class="p-button-rounded p-button-info p-mr-2"
                                    (click)="viewFreeTrial(freeTrial)"></button>
                            <button pButton pRipple icon="pi pi-trash" class="p-button-rounded p-button-danger p-mr-2"
                                    (click)="deleteFreeTrial(freeTrial)"></button>

                            <button pButton pRipple icon="pi pi-copy" class="p-button-rounded p-button-raised p-button-warning"
                                    (click)="duplicateFreeTrial(freeTrial)"></button>
                        </td>
                    </tr>
                </ng-template>

                <ng-template pTemplate="summary">
                    <p-paginator  [rows]="10" [totalRecords]="totalRecords" (onPageChange)="onPage($event)"></p-paginator>
                    <div class="p-d-flex p-ai-center p-jc-between">
                        En totale il {{freeTrials ? totalRecords == 1 ? 'y a' : 'y a' : 'y a' }} {{freeTrials ? totalRecords : 0 }} {{freeTrials ? totalRecords == 1 ? 'free trial' : 'free trials' : 0 }}.
                    </div>
                </ng-template>
            </p-table>
        </div>

        <app-free-trial-create-admin></app-free-trial-create-admin>
        <app-free-trial-edit-admin></app-free-trial-edit-admin>
        <app-free-trial-view-admin></app-free-trial-view-admin>
        <p-confirmDialog [style]="{width: '450px'}"></p-confirmDialog>
    </div>
</div>
